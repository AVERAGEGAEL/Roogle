<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Google</title>
  <link rel="icon" href="Google.png" type="image/png">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <h1>Roogle</h1>
  <div class="input-wrapper">
    <input type="text" id="urlInput" placeholder="Enter a URL">
    <button onclick="loadSite()">Go</button>
    <button onclick="loadRoogleSearch()" class="search-button">Roogle Search</button>
  </div>
  
  <div id="error-message" style="display:none; color:red; font-size:16px;">This site is blocked from being embedded here.</div>
  
  <iframe id="proxyFrame" src="" frameborder="0"></iframe>

  <script>
    function loadSite() {
      const input = document.getElementById('urlInput').value.trim();
      if (!input) return;

      let formattedUrl = input;

      // Smarter handling of https:// auto-add
      if (!formattedUrl.startsWith("http://") && !formattedUrl.startsWith("https://")) {
        formattedUrl = "https://" + formattedUrl;
      }

      // Handle YouTube links
      if (formattedUrl.includes("youtube.com")) {
        formattedUrl = formatYouTubeURL(formattedUrl);
      }

      const iframe = document.getElementById('proxyFrame');
      const errorMessage = document.getElementById('error-message');
      iframe.src = `https://fallen-america.uraverageopdoge.workers.dev/${formattedUrl}`;
      
      // Check if iframe is loading properly
      iframe.onload = function() {
        errorMessage.style.display = "none"; // Hide error message if page loads successfully
      };
      iframe.onerror = function() {
        errorMessage.style.display = "block"; // Show error message if iframe fails to load
      };
    }

    // Special handling for YouTube embed links
    function formatYouTubeURL(url) {
      const videoId = url.split("v=")[1];
      if (videoId) {
        return `https://www.youtube.com/embed/${videoId}`;
      }
      return url;
    }

    function loadRoogleSearch() {
      const searchUrl = "https://averagegael.github.io/Roogle-search/";
      document.getElementById('urlInput').value = searchUrl;
      document.getElementById('proxyFrame').src = `https://fallen-america.uraverageopdoge.workers.dev/${searchUrl}`;
    }
  </script>
</body>
</html>
